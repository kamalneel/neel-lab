<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon" type="image/png" href="../faviconV4.png">
  <title>401k Pundit - When Enough is Enough - Neel Labs</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Outfit:wght@400;500;600;700&family=Space+Grotesk:wght@500;600;700&display=swap" rel="stylesheet">

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <style>
    :root {
      --color-bg-primary: #0D0D0D;
      --color-bg-secondary: #1A1A1A;
      --color-bg-tertiary: #242424;
      --color-text-primary: #FFFFFF;
      --color-text-secondary: #A3A3A3;
      --color-text-tertiary: #737373;
      --color-accent: #00D632;
      --color-accent-hover: #00E639;
      --color-accent-muted: rgba(0, 214, 50, 0.12);
      --color-gold: #C9A227;
      --color-gold-muted: rgba(201, 162, 39, 0.15);
      --color-blue: #3B82F6;
      --color-blue-muted: rgba(59, 130, 246, 0.15);
      --color-red: #EF4444;
      --color-red-muted: rgba(239, 68, 68, 0.12);
      --color-border: rgba(255, 255, 255, 0.08);
      --font-sans: 'Outfit', -apple-system, BlinkMacSystemFont, sans-serif;
      --font-display: 'Space Grotesk', 'Outfit', sans-serif;
      --font-mono: 'JetBrains Mono', 'SF Mono', monospace;
      --space-1: 0.25rem;
      --space-2: 0.5rem;
      --space-3: 0.75rem;
      --space-4: 1rem;
      --space-6: 1.5rem;
      --space-8: 2rem;
      --space-12: 3rem;
      --radius-md: 8px;
      --radius-lg: 12px;
      --radius-xl: 16px;
    }

    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      -webkit-font-smoothing: antialiased;
      scroll-behavior: smooth;
    }

    body {
      font-family: var(--font-sans);
      background: var(--color-bg-primary);
      color: var(--color-text-primary);
      line-height: 1.6;
      min-height: 100vh;
    }

    a { color: inherit; text-decoration: none; }

    /* Header */
    .app-header {
      position: sticky;
      top: 0;
      z-index: 100;
      background: rgba(13, 13, 13, 0.95);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--color-border);
      padding: var(--space-3) var(--space-6);
    }

    .app-header-container {
      max-width: 1000px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .app-header-left {
      display: flex;
      align-items: center;
      gap: var(--space-4);
    }

    .app-logo img {
      height: 40px;
      border-radius: var(--radius-md);
    }

    .app-title {
      font-family: var(--font-display);
      font-size: 1.25rem;
      font-weight: 600;
    }

    .app-title span { color: var(--color-blue); }

    .back-link {
      color: var(--color-text-secondary);
      font-size: 0.875rem;
      padding: var(--space-2) var(--space-4);
      border-radius: var(--radius-md);
      border: 1px solid var(--color-border);
      transition: all 0.2s ease;
    }

    .back-link:hover {
      color: var(--color-accent);
      border-color: rgba(0, 214, 50, 0.3);
      background: var(--color-accent-muted);
    }

    /* Main */
    .app-main {
      max-width: 1000px;
      margin: 0 auto;
      padding: var(--space-8) var(--space-6);
    }

    /* Hero Section */
    .hero-section {
      text-align: center;
      padding: var(--space-12) 0;
      margin-bottom: var(--space-8);
    }

    .hero-badge {
      display: inline-block;
      background: var(--color-blue-muted);
      color: var(--color-blue);
      padding: var(--space-2) var(--space-4);
      border-radius: 100px;
      font-size: 0.875rem;
      font-weight: 600;
      margin-bottom: var(--space-6);
    }

    .hero-title {
      font-family: var(--font-display);
      font-size: clamp(2.5rem, 6vw, 4rem);
      font-weight: 700;
      line-height: 1.1;
      margin-bottom: var(--space-6);
    }

    .hero-title .accent { color: var(--color-accent); }

    .hero-subtitle {
      font-size: 1.25rem;
      color: var(--color-text-secondary);
      max-width: 600px;
      margin: 0 auto var(--space-8);
      line-height: 1.7;
    }

    /* Input Card */
    .input-card {
      background: var(--color-bg-secondary);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-xl);
      padding: var(--space-8);
      max-width: 700px;
      margin: 0 auto;
    }

    .input-card h3 {
      font-family: var(--font-display);
      font-size: 1.25rem;
      margin-bottom: var(--space-6);
      text-align: center;
    }

    .input-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: var(--space-6);
      margin-bottom: var(--space-6);
    }

    @media (max-width: 700px) {
      .input-grid { grid-template-columns: 1fr; }
    }

    .input-group { text-align: center; }

    .input-group label {
      display: block;
      font-size: 0.875rem;
      color: var(--color-text-secondary);
      margin-bottom: var(--space-2);
    }

    .input-group input {
      width: 100%;
      padding: var(--space-4);
      background: var(--color-bg-tertiary);
      border: 2px solid var(--color-border);
      border-radius: var(--radius-lg);
      color: var(--color-text-primary);
      font-family: var(--font-mono);
      font-size: 1.5rem;
      font-weight: 600;
      text-align: center;
      transition: all 0.2s ease;
    }

    .input-group input:focus {
      outline: none;
      border-color: var(--color-accent);
      box-shadow: 0 0 0 4px var(--color-accent-muted);
    }

    .input-group .hint {
      font-size: 0.75rem;
      color: var(--color-text-tertiary);
      margin-top: var(--space-2);
    }

    .calculate-btn {
      width: 100%;
      padding: var(--space-4);
      background: var(--color-accent);
      color: #000;
      border: none;
      border-radius: var(--radius-lg);
      font-family: var(--font-sans);
      font-size: 1.125rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .calculate-btn:hover {
      background: var(--color-accent-hover);
      transform: translateY(-2px);
      box-shadow: 0 4px 20px rgba(0, 214, 50, 0.3);
    }

    /* Results Section */
    .results-section {
      display: none;
      margin-top: var(--space-12);
    }

    .results-section.visible {
      display: block;
      animation: fadeIn 0.5s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    /* Section Titles */
    .section-title {
      font-family: var(--font-display);
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: var(--space-6);
      display: flex;
      align-items: center;
      gap: var(--space-3);
    }

    .section-title .number {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 32px;
      height: 32px;
      background: var(--color-blue);
      color: #000;
      border-radius: 50%;
      font-size: 0.875rem;
      font-weight: 700;
    }

    /* Cards */
    .card {
      background: var(--color-bg-secondary);
      border: 1px solid var(--color-border);
      border-radius: var(--radius-xl);
      padding: var(--space-6);
      margin-bottom: var(--space-8);
    }

    .card h4 {
      font-family: var(--font-display);
      font-size: 1rem;
      color: var(--color-text-secondary);
      margin-bottom: var(--space-4);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    /* Tables */
    .data-table {
      width: 100%;
      border-collapse: collapse;
    }

    .data-table th,
    .data-table td {
      padding: var(--space-3) var(--space-4);
      text-align: left;
      border-bottom: 1px solid var(--color-border);
    }

    .data-table th {
      color: var(--color-text-tertiary);
      font-weight: 500;
      font-size: 0.75rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .data-table td {
      font-family: var(--font-mono);
      font-size: 0.95rem;
    }

    .data-table td:last-child {
      text-align: right;
      font-weight: 600;
    }

    .data-table tr:last-child td {
      border-bottom: none;
    }

    .data-table .total-row td {
      border-top: 2px solid var(--color-border);
      font-weight: 700;
      font-size: 1.1rem;
      padding-top: var(--space-4);
    }

    .data-table .highlight { color: var(--color-accent); }
    .data-table .blue { color: var(--color-blue); }
    .data-table .gold { color: var(--color-gold); }
    .data-table .red { color: var(--color-red); }

    /* Assumptions Grid */
    .assumptions-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: var(--space-4);
    }

    .assumption-item {
      background: var(--color-bg-tertiary);
      border-radius: var(--radius-md);
      padding: var(--space-4);
      text-align: center;
    }

    .assumption-item .value {
      font-family: var(--font-mono);
      font-size: 1.25rem;
      font-weight: 600;
      color: var(--color-text-primary);
    }

    .assumption-item .label {
      font-size: 0.7rem;
      color: var(--color-text-tertiary);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-top: var(--space-1);
    }

    /* Big Number Display */
    .big-number {
      text-align: center;
      padding: var(--space-6);
      background: var(--color-bg-tertiary);
      border-radius: var(--radius-lg);
      margin-bottom: var(--space-6);
    }

    .big-number .label {
      font-size: 0.875rem;
      color: var(--color-text-tertiary);
      text-transform: uppercase;
      letter-spacing: 0.1em;
      margin-bottom: var(--space-2);
    }

    .big-number .amount {
      font-family: var(--font-mono);
      font-size: 3rem;
      font-weight: 700;
    }

    .big-number .amount.green { color: var(--color-accent); }
    .big-number .amount.blue { color: var(--color-blue); }
    .big-number .amount.gold { color: var(--color-gold); }
    .big-number .amount.red { color: var(--color-red); }

    .big-number .subtitle {
      font-size: 0.875rem;
      color: var(--color-text-secondary);
      margin-top: var(--space-2);
    }

    /* Chart */
    .chart-container {
      height: 400px;
      position: relative;
      margin-top: var(--space-6);
    }

    /* Verdict */
    .verdict-banner {
      text-align: center;
      padding: var(--space-8);
      border-radius: var(--radius-xl);
      margin-bottom: var(--space-8);
    }

    .verdict-banner.success {
      background: linear-gradient(135deg, var(--color-accent-muted), var(--color-bg-secondary));
      border: 2px solid var(--color-accent);
    }

    .verdict-banner.warning {
      background: linear-gradient(135deg, var(--color-gold-muted), var(--color-bg-secondary));
      border: 2px solid var(--color-gold);
    }

    .verdict-banner.danger {
      background: linear-gradient(135deg, var(--color-red-muted), var(--color-bg-secondary));
      border: 2px solid var(--color-red);
    }

    .verdict-banner .icon { font-size: 4rem; margin-bottom: var(--space-4); }

    .verdict-banner .title {
      font-family: var(--font-display);
      font-size: 2rem;
      font-weight: 700;
      margin-bottom: var(--space-4);
    }

    .verdict-banner.success .title { color: var(--color-accent); }
    .verdict-banner.warning .title { color: var(--color-gold); }
    .verdict-banner.danger .title { color: var(--color-red); }

    .verdict-banner .message {
      font-size: 1.125rem;
      color: var(--color-text-secondary);
      max-width: 600px;
      margin: 0 auto;
      line-height: 1.7;
    }

    /* THE BIG ANSWER - Stop Age Hero */
    .stop-age-hero {
      background: linear-gradient(135deg, #1a1a2e 0%, #0D0D0D 100%);
      border: 3px solid var(--color-accent);
      border-radius: var(--radius-xl);
      padding: var(--space-12);
      text-align: center;
      margin-bottom: var(--space-8);
      position: relative;
      overflow: hidden;
    }

    .stop-age-hero::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle at center, rgba(0, 214, 50, 0.1) 0%, transparent 50%);
      pointer-events: none;
    }

    .stop-age-label {
      display: inline-block;
      background: var(--color-accent);
      color: #000;
      padding: var(--space-2) var(--space-6);
      border-radius: 100px;
      font-size: 0.875rem;
      font-weight: 700;
      letter-spacing: 0.1em;
      margin-bottom: var(--space-6);
    }

    .stop-age-question {
      font-family: var(--font-display);
      font-size: 1.5rem;
      color: var(--color-text-secondary);
      margin-bottom: var(--space-4);
    }

    .stop-age-answer {
      font-family: var(--font-mono);
      font-size: clamp(4rem, 12vw, 7rem);
      font-weight: 700;
      color: var(--color-accent);
      line-height: 1;
      margin-bottom: var(--space-6);
      text-shadow: 0 0 60px rgba(0, 214, 50, 0.5);
    }

    .stop-age-explanation {
      font-size: 1.125rem;
      color: var(--color-text-secondary);
      max-width: 600px;
      margin: 0 auto var(--space-8);
      line-height: 1.7;
    }

    .stop-age-stats {
      display: flex;
      justify-content: center;
      gap: var(--space-8);
      flex-wrap: wrap;
    }

    .stop-age-stat {
      text-align: center;
      min-width: 120px;
    }

    .stop-age-stat .value {
      font-family: var(--font-mono);
      font-size: 1.5rem;
      font-weight: 600;
      color: var(--color-text-primary);
    }

    .stop-age-stat .label {
      font-size: 0.75rem;
      color: var(--color-text-tertiary);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-top: var(--space-1);
    }

    .stop-age-hero.already-enough {
      border-color: var(--color-gold);
    }

    .stop-age-hero.already-enough .stop-age-label {
      background: var(--color-gold);
    }

    .stop-age-hero.already-enough .stop-age-answer {
      color: var(--color-gold);
      text-shadow: 0 0 60px rgba(201, 162, 39, 0.5);
    }

    .stop-age-hero.need-more {
      border-color: var(--color-red);
    }

    .stop-age-hero.need-more .stop-age-label {
      background: var(--color-red);
    }

    .stop-age-hero.need-more .stop-age-answer {
      color: var(--color-red);
      text-shadow: 0 0 60px rgba(239, 68, 68, 0.5);
    }

    @media (max-width: 600px) {
      .stop-age-hero {
        padding: var(--space-8);
      }

      .stop-age-answer {
        font-size: 4rem;
      }

      .stop-age-stats {
        gap: var(--space-4);
      }
    }

    /* Footer */
    .app-footer {
      background: var(--color-bg-secondary);
      border-top: 1px solid var(--color-border);
      padding: var(--space-6);
      margin-top: var(--space-12);
      text-align: center;
      font-size: 0.875rem;
      color: var(--color-text-tertiary);
    }

    .app-footer a { color: var(--color-accent); }

    .disclaimer {
      max-width: 700px;
      margin: 0 auto var(--space-4);
      padding: var(--space-4);
      background: var(--color-bg-tertiary);
      border-radius: var(--radius-md);
      font-size: 0.75rem;
      line-height: 1.6;
    }

    /* Responsive */
    @media (max-width: 600px) {
      .hero-title { font-size: 2rem; }
      .big-number .amount { font-size: 2rem; }
      .assumptions-grid { grid-template-columns: repeat(2, 1fr); }
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="app-header">
    <div class="app-header-container">
      <div class="app-header-left">
        <a href="/" class="app-logo">
          <img src="../LogoV2.png" alt="Neel Labs">
        </a>
        <span class="app-title">401k <span>Pundit</span></span>
      </div>
      <a href="/" class="back-link">Back to Neel Labs</a>
    </div>
  </header>

  <main class="app-main">
    <!-- Hero Section -->
    <section class="hero-section">
      <div class="hero-badge">Retirement Planning</div>
      <h1 class="hero-title">
        When <span class="accent">Enough</span><br>is Enough
      </h1>
      <p class="hero-subtitle">
        Everyone tells you to max out your 401k. But at what point have you saved
        <em>enough</em> for retirement? This calculator finds that magic number.
      </p>
    </section>

    <!-- Input Card -->
    <div class="input-card">
      <h3>Enter Your Current Retirement Savings</h3>

      <div class="input-grid">
        <div class="input-group">
          <label>Your Current Age</label>
          <input type="number" id="currentAge" value="46" min="25" max="59">
          <div class="hint">You (or younger spouse)</div>
        </div>

        <div class="input-group">
          <label>Combined IRA Balance</label>
          <input type="text" id="iraBalance" value="800,000" oninput="formatNumber(this)">
          <div class="hint">You + Spouse (rolled 401k)</div>
        </div>

        <div class="input-group">
          <label>Combined Roth IRA</label>
          <input type="text" id="rothBalance" value="50,000" oninput="formatNumber(this)">
          <div class="hint">You + Spouse</div>
        </div>
      </div>

      <button class="calculate-btn" onclick="calculate()">
        Show Me the Numbers
      </button>
    </div>

    <!-- Results Section -->
    <section class="results-section" id="results">

      <!-- 1. Assumptions -->
      <h2 class="section-title"><span class="number">1</span> Our Assumptions</h2>
      <div class="card">
        <div class="assumptions-grid">
          <div class="assumption-item">
            <div class="value">60</div>
            <div class="label">Retirement Age</div>
          </div>
          <div class="assumption-item">
            <div class="value">90</div>
            <div class="label">Life Expectancy</div>
          </div>
          <div class="assumption-item">
            <div class="value">8%</div>
            <div class="label">Annual Growth</div>
          </div>
          <div class="assumption-item">
            <div class="value">$47K</div>
            <div class="label">Annual 401k (couple)</div>
          </div>
          <div class="assumption-item">
            <div class="value">$400K</div>
            <div class="label">Golden Number</div>
          </div>
          <div class="assumption-item">
            <div class="value">~33%</div>
            <div class="label">Tax Rate (Fed+CA)</div>
          </div>
        </div>
      </div>

      <!-- 2. Your Current Balances -->
      <h2 class="section-title"><span class="number">2</span> Your Current Balances</h2>
      <div class="card">
        <table class="data-table">
          <thead>
            <tr>
              <th>Account</th>
              <th>Balance</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Traditional IRA (You + Spouse)</td>
              <td id="tableIRA">$800,000</td>
            </tr>
            <tr>
              <td>Roth IRA (You + Spouse)</td>
              <td id="tableRoth">$50,000</td>
            </tr>
            <tr class="total-row">
              <td>Total Current Retirement Savings</td>
              <td class="highlight" id="tableTotal">$850,000</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- 3. Projection to Age 60 -->
      <h2 class="section-title"><span class="number">3</span> Growing Your Nest Egg to Age 60</h2>
      <div class="card">
        <table class="data-table">
          <thead>
            <tr>
              <th>Component</th>
              <th>Amount</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Current Balance</td>
              <td id="projCurrentBalance">$850,000</td>
            </tr>
            <tr>
              <td>Growth on Current Balance (8% for <span id="projYears">14</span> years)</td>
              <td class="blue" id="projGrowthOnCurrent">+$1,648,000</td>
            </tr>
            <tr>
              <td>Future 401k Contributions ($47K/yr Ã— <span id="projYears2">14</span> years)</td>
              <td id="projContributions">$658,000</td>
            </tr>
            <tr>
              <td>Growth on Contributions</td>
              <td class="blue" id="projGrowthOnContrib">+$466,000</td>
            </tr>
            <tr class="total-row">
              <td>Projected Balance at Age 60</td>
              <td class="highlight" id="projTotal">$3,622,000</td>
            </tr>
          </tbody>
        </table>

        <div class="big-number" style="margin-top: var(--space-6);">
          <div class="label">Your Nest Egg at 60</div>
          <div class="amount blue" id="bigNestEgg">$3.6M</div>
        </div>
      </div>

      <!-- 4. Retirement Spending (60-90) -->
      <h2 class="section-title"><span class="number">4</span> Your Retirement Lifestyle (Age 60-90)</h2>
      <div class="card">
        <h4>Annual Withdrawal Breakdown</h4>
        <table class="data-table">
          <thead>
            <tr>
              <th>Item</th>
              <th>Amount</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Annual Withdrawal (Golden Number)</td>
              <td class="gold">$400,000</td>
            </tr>
            <tr>
              <td>Federal Tax (24%)</td>
              <td class="red">-$96,000</td>
            </tr>
            <tr>
              <td>California State Tax (~9.3%)</td>
              <td class="red">-$37,200</td>
            </tr>
            <tr class="total-row">
              <td>Annual After-Tax Spending</td>
              <td class="highlight">$266,800</td>
            </tr>
          </tbody>
        </table>

        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-4); margin-top: var(--space-6);">
          <div class="big-number">
            <div class="label">Monthly Spending</div>
            <div class="amount green">$22,233</div>
          </div>
          <div class="big-number">
            <div class="label">30-Year Total Spending</div>
            <div class="amount gold">$8.0M</div>
          </div>
        </div>
      </div>

      <!-- 5. What's Left at 90 -->
      <h2 class="section-title"><span class="number">5</span> Retirement: Spending + Growing (Age 60-90)</h2>
      <div class="card">
        <h4>Each Year: Withdraw $400K, Then Grow Remainder at 8%</h4>

        <div class="big-number">
          <div class="label">Remaining Balance at Age 90</div>
          <div class="amount" id="bigRemaining">$2.1M</div>
          <div class="subtitle" id="remainingSubtitle">You won't run out of money!</div>
        </div>

        <table class="data-table" id="decumulationSummary">
          <thead>
            <tr>
              <th>30 Years of Retirement</th>
              <th>Amount</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Starting Balance at 60</td>
              <td id="summaryStart">$3,622,000</td>
            </tr>
            <tr>
              <td>Total Withdrawn (30 years Ã— $400K)</td>
              <td class="red" id="summaryWithdrawn">-$12,000,000</td>
            </tr>
            <tr>
              <td>Total Growth During Retirement (8%/yr on remainder)</td>
              <td class="blue" id="summaryGrowth">+$10,500,000</td>
            </tr>
            <tr class="total-row">
              <td>Remaining at 90</td>
              <td id="summaryRemaining">$2,122,000</td>
            </tr>
          </tbody>
        </table>

        <div style="margin-top: var(--space-4); padding: var(--space-4); background: var(--color-bg-tertiary); border-radius: var(--radius-md); font-size: 0.875rem; color: var(--color-text-secondary);">
          <strong>How it works:</strong> Each year you withdraw $400K for living expenses,
          then your remaining balance grows 8%. This is why you can withdraw more than your starting balance â€”
          your money keeps working for you even in retirement.
        </div>
      </div>

      <!-- THE BIG ANSWER -->
      <div class="stop-age-hero" id="stopAgeHero">
        <div class="stop-age-label">THE ANSWER</div>
        <div class="stop-age-question">When Should You Stop Contributing?</div>
        <div class="stop-age-answer" id="stopAgeAnswer">Age 52</div>
        <div class="stop-age-explanation" id="stopAgeExplanation">
          If you stop 401k contributions at age 52, you'll have just enough to withdraw $400K/year
          until age 90 and end with near-zero balance. Every year you contribute beyond this is gravy.
        </div>
        <div class="stop-age-stats">
          <div class="stop-age-stat">
            <div class="value" id="stopAgeYearsLeft">6 years</div>
            <div class="label">More to Contribute</div>
          </div>
          <div class="stop-age-stat">
            <div class="value" id="stopAgeSavings">$282K</div>
            <div class="label">401k Savings After Stop</div>
          </div>
          <div class="stop-age-stat">
            <div class="value" id="stopAgeBalance60">$3.2M</div>
            <div class="label">Balance at 60</div>
          </div>
        </div>
      </div>

      <!-- Verdict -->
      <div class="verdict-banner success" id="verdictBanner">
        <div class="icon" id="verdictIcon">ğŸ¯</div>
        <div class="title" id="verdictTitle">You're On Track!</div>
        <div class="message" id="verdictMessage">
          With your current savings and continued 401k contributions, you'll have more than enough
          to withdraw $400K/year for 30 years. You might even consider reducing your 401k contributions
          and investing in taxable accounts for more flexibility.
        </div>
      </div>

      <!-- 6. The Full Picture (Chart) -->
      <h2 class="section-title"><span class="number">6</span> The Full Picture</h2>
      <div class="card">
        <h4>Your Wealth Journey: Today â†’ 60 â†’ 90</h4>
        <div class="chart-container">
          <canvas id="wealthChart"></canvas>
        </div>
      </div>

    </section>
  </main>

  <!-- Footer -->
  <footer class="app-footer">
    <div class="disclaimer">
      <strong>Disclaimer:</strong> This calculator provides estimates for educational purposes only.
      Actual results depend on market conditions, tax law changes, and individual circumstances.
      The 8% growth assumption is optimistic â€” actual returns may vary significantly.
      Consult a qualified financial advisor for personalized advice.
    </div>
    <p>
      401k Pundit by <a href="/">Neel Labs</a> Â·
      <em>When enough is enough</em>
    </p>
  </footer>

  <script>
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // CONSTANTS
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    const RETIREMENT_AGE = 60;
    const LIFE_EXPECTANCY = 90;
    const GROWTH_RATE = 0.08;
    const ANNUAL_401K_CONTRIBUTION = 47000; // ~$23.5K Ã— 2 for couple
    const GOLDEN_NUMBER = 400000;
    const FEDERAL_TAX_RATE = 0.24;
    const STATE_TAX_RATE = 0.093; // California
    const COMBINED_TAX_RATE = FEDERAL_TAX_RATE + STATE_TAX_RATE;

    let wealthChart = null;

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // UTILITY FUNCTIONS
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    function formatNumber(input) {
      let value = input.value.replace(/[^\d]/g, '');
      if (value) {
        input.value = parseInt(value).toLocaleString();
      }
    }

    function parseNumber(str) {
      return parseFloat(str.replace(/[^\d.-]/g, '')) || 0;
    }

    function formatCurrency(num) {
      if (Math.abs(num) >= 1e6) {
        return '$' + (num / 1e6).toFixed(1) + 'M';
      } else if (Math.abs(num) >= 1e3) {
        return '$' + Math.round(num / 1e3).toLocaleString() + 'K';
      }
      return '$' + num.toLocaleString(undefined, { maximumFractionDigits: 0 });
    }

    function formatFullCurrency(num) {
      return '$' + Math.round(num).toLocaleString();
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // STOP AGE CALCULATION
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    function simulateWithStopAge(totalCurrent, currentAge, stopAge) {
      // Phase 1: Accumulation with contributions until stopAge, then just growth
      let balance = totalCurrent;

      for (let age = currentAge; age < RETIREMENT_AGE; age++) {
        // Add contribution only if before stop age
        const contribution = age < stopAge ? ANNUAL_401K_CONTRIBUTION : 0;
        balance = balance * (1 + GROWTH_RATE) + contribution;
      }

      const balanceAt60 = balance;

      // Phase 2: Decumulation from 60 to 90
      for (let age = RETIREMENT_AGE; age < LIFE_EXPECTANCY; age++) {
        balance -= GOLDEN_NUMBER;
        if (balance <= 0) return { balanceAt60, remaining: 0, ranOut: true, ranOutAge: age };
        balance *= (1 + GROWTH_RATE);
      }

      return { balanceAt60, remaining: balance, ranOut: false };
    }

    function findOptimalStopAge(totalCurrent, currentAge) {
      // Binary search for the stop age that results in near-zero at 90
      // We want the earliest age where remaining >= 0

      let bestStopAge = currentAge;
      let bestRemaining = Infinity;

      // Check if already enough (stop contributing now)
      const ifStopNow = simulateWithStopAge(totalCurrent, currentAge, currentAge);
      if (ifStopNow.remaining > 0) {
        // Already have enough! Find earliest stop age
        bestStopAge = currentAge;
        bestRemaining = ifStopNow.remaining;

        // But maybe we had enough even earlier - check if current balance alone works
        // This means "you already have enough, could have stopped years ago"
        return {
          stopAge: currentAge,
          status: 'already-enough',
          balanceAt60: ifStopNow.balanceAt60,
          remaining: ifStopNow.remaining
        };
      }

      // Need to find when to stop
      // Search from current age to 60
      for (let stopAge = currentAge; stopAge <= RETIREMENT_AGE; stopAge++) {
        const result = simulateWithStopAge(totalCurrent, currentAge, stopAge);

        if (result.remaining >= 0 && result.remaining < bestRemaining) {
          bestStopAge = stopAge;
          bestRemaining = result.remaining;
        }

        // If we found a stop age that works (remaining >= 0),
        // and it's close to zero, that's our answer
        if (result.remaining >= 0 && result.remaining < 500000) {
          return {
            stopAge: stopAge,
            status: 'found',
            balanceAt60: result.balanceAt60,
            remaining: result.remaining
          };
        }
      }

      // Check if even contributing till 60 isn't enough
      const ifContributeTill60 = simulateWithStopAge(totalCurrent, currentAge, RETIREMENT_AGE);
      if (ifContributeTill60.remaining <= 0) {
        return {
          stopAge: RETIREMENT_AGE,
          status: 'need-more',
          balanceAt60: ifContributeTill60.balanceAt60,
          remaining: ifContributeTill60.remaining
        };
      }

      // Return best found
      return {
        stopAge: bestStopAge,
        status: 'found',
        balanceAt60: simulateWithStopAge(totalCurrent, currentAge, bestStopAge).balanceAt60,
        remaining: bestRemaining
      };
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // CALCULATION ENGINE
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    function calculate() {
      // Get inputs
      const currentAge = parseInt(document.getElementById('currentAge').value);
      const iraBalance = parseNumber(document.getElementById('iraBalance').value);
      const rothBalance = parseNumber(document.getElementById('rothBalance').value);

      const totalCurrent = iraBalance + rothBalance;
      const yearsToRetirement = Math.max(0, RETIREMENT_AGE - currentAge);
      const yearsInRetirement = LIFE_EXPECTANCY - RETIREMENT_AGE;

      // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      // PHASE 1: Accumulation (Current Age â†’ 60)
      // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

      // Growth on existing balance
      const growthMultiplier = Math.pow(1 + GROWTH_RATE, yearsToRetirement);
      const futureValueOfCurrent = totalCurrent * growthMultiplier;
      const growthOnCurrent = futureValueOfCurrent - totalCurrent;

      // Future value of annual contributions (annuity)
      // FV = PMT Ã— [((1 + r)^n - 1) / r]
      let futureValueOfContributions = 0;
      let growthOnContributions = 0;
      const totalContributions = ANNUAL_401K_CONTRIBUTION * yearsToRetirement;

      if (yearsToRetirement > 0) {
        futureValueOfContributions = ANNUAL_401K_CONTRIBUTION *
          ((Math.pow(1 + GROWTH_RATE, yearsToRetirement) - 1) / GROWTH_RATE);
        growthOnContributions = futureValueOfContributions - totalContributions;
      }

      const balanceAt60 = futureValueOfCurrent + futureValueOfContributions;

      // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      // PHASE 2: Decumulation (60 â†’ 90)
      // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

      // Simulate year by year
      const yearlyData = [];
      let balance = balanceAt60;
      let totalWithdrawn = 0;
      let totalGrowthInRetirement = 0;

      // Add accumulation phase data points
      let accumulationBalance = totalCurrent;
      for (let age = currentAge; age <= RETIREMENT_AGE; age++) {
        yearlyData.push({
          age,
          balance: accumulationBalance,
          phase: 'accumulation'
        });

        if (age < RETIREMENT_AGE) {
          accumulationBalance = accumulationBalance * (1 + GROWTH_RATE) + ANNUAL_401K_CONTRIBUTION;
        }
      }

      // Add decumulation phase data points
      balance = balanceAt60;
      for (let age = RETIREMENT_AGE; age <= LIFE_EXPECTANCY; age++) {
        if (age > RETIREMENT_AGE) {
          // Withdraw at start of year
          balance -= GOLDEN_NUMBER;
          totalWithdrawn += GOLDEN_NUMBER;

          // Grow remainder
          const growth = balance * GROWTH_RATE;
          totalGrowthInRetirement += growth;
          balance += growth;
        }

        yearlyData.push({
          age,
          balance: Math.max(0, balance),
          phase: 'decumulation'
        });
      }

      const remainingAt90 = Math.max(0, balance);

      // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      // UPDATE UI
      // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

      // Section 2: Current Balances
      document.getElementById('tableIRA').textContent = formatFullCurrency(iraBalance);
      document.getElementById('tableRoth').textContent = formatFullCurrency(rothBalance);
      document.getElementById('tableTotal').textContent = formatFullCurrency(totalCurrent);

      // Section 3: Projection to 60
      document.getElementById('projYears').textContent = yearsToRetirement;
      document.getElementById('projYears2').textContent = yearsToRetirement;
      document.getElementById('projCurrentBalance').textContent = formatFullCurrency(totalCurrent);
      document.getElementById('projGrowthOnCurrent').textContent = '+' + formatFullCurrency(growthOnCurrent);
      document.getElementById('projContributions').textContent = formatFullCurrency(totalContributions);
      document.getElementById('projGrowthOnContrib').textContent = '+' + formatFullCurrency(growthOnContributions);
      document.getElementById('projTotal').textContent = formatFullCurrency(balanceAt60);
      document.getElementById('bigNestEgg').textContent = formatCurrency(balanceAt60);

      // Section 5: What's Left at 90
      document.getElementById('summaryStart').textContent = formatFullCurrency(balanceAt60);
      document.getElementById('summaryWithdrawn').textContent = '-' + formatFullCurrency(totalWithdrawn);
      document.getElementById('summaryGrowth').textContent = '+' + formatFullCurrency(totalGrowthInRetirement);
      document.getElementById('summaryRemaining').textContent = formatFullCurrency(remainingAt90);

      const bigRemaining = document.getElementById('bigRemaining');
      const remainingSubtitle = document.getElementById('remainingSubtitle');
      bigRemaining.textContent = formatCurrency(remainingAt90);

      if (remainingAt90 > 0) {
        bigRemaining.className = 'amount green';
        remainingSubtitle.textContent = "You won't run out of money!";
      } else {
        bigRemaining.className = 'amount red';
        remainingSubtitle.textContent = "Warning: You may run out of money before 90.";
      }

      // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
      // THE BIG ANSWER: When to Stop Contributing
      // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

      const stopAgeResult = findOptimalStopAge(totalCurrent, currentAge);
      const stopAgeHero = document.getElementById('stopAgeHero');
      const stopAgeAnswer = document.getElementById('stopAgeAnswer');
      const stopAgeExplanation = document.getElementById('stopAgeExplanation');
      const stopAgeYearsLeft = document.getElementById('stopAgeYearsLeft');
      const stopAgeSavings = document.getElementById('stopAgeSavings');
      const stopAgeBalance60 = document.getElementById('stopAgeBalance60');

      if (stopAgeResult.status === 'already-enough') {
        // Already have enough - could stop now!
        stopAgeHero.className = 'stop-age-hero already-enough';
        stopAgeAnswer.textContent = 'NOW!';
        stopAgeExplanation.innerHTML = `
          <strong>Congratulations!</strong> You already have enough saved. If you stopped contributing today,
          you'd still have <strong>${formatCurrency(stopAgeResult.remaining)}</strong> left at age 90.
          Consider redirecting 401k contributions to taxable accounts for more flexibility.
        `;
        stopAgeYearsLeft.textContent = '0 years';
        stopAgeSavings.textContent = '$0';
        stopAgeBalance60.textContent = formatCurrency(stopAgeResult.balanceAt60);
      } else if (stopAgeResult.status === 'need-more') {
        // Need to keep contributing past 60
        stopAgeHero.className = 'stop-age-hero need-more';
        stopAgeAnswer.textContent = 'Keep Going';
        stopAgeExplanation.innerHTML = `
          Even with maximum contributions until 60, you may not have enough to withdraw $400K/year for 30 years.
          Consider increasing savings, delaying retirement, or adjusting your income expectations.
        `;
        stopAgeYearsLeft.textContent = `${RETIREMENT_AGE - currentAge} years`;
        stopAgeSavings.textContent = formatCurrency(ANNUAL_401K_CONTRIBUTION * (RETIREMENT_AGE - currentAge));
        stopAgeBalance60.textContent = formatCurrency(stopAgeResult.balanceAt60);
      } else {
        // Found optimal stop age
        const yearsToContribute = stopAgeResult.stopAge - currentAge;
        const savingsAfterStop = ANNUAL_401K_CONTRIBUTION * yearsToContribute;

        stopAgeHero.className = 'stop-age-hero';
        stopAgeAnswer.textContent = `Age ${stopAgeResult.stopAge}`;
        stopAgeExplanation.innerHTML = `
          If you stop 401k contributions at <strong>age ${stopAgeResult.stopAge}</strong>, you'll have just enough
          to withdraw $400K/year until age 90 and end with <strong>${formatCurrency(stopAgeResult.remaining)}</strong>.
          Every year you contribute beyond this is bonus money!
        `;
        stopAgeYearsLeft.textContent = `${yearsToContribute} years`;
        stopAgeSavings.textContent = formatCurrency(savingsAfterStop);
        stopAgeBalance60.textContent = formatCurrency(stopAgeResult.balanceAt60);
      }

      // Verdict Banner
      const verdictBanner = document.getElementById('verdictBanner');
      const verdictIcon = document.getElementById('verdictIcon');
      const verdictTitle = document.getElementById('verdictTitle');
      const verdictMessage = document.getElementById('verdictMessage');

      if (remainingAt90 > balanceAt60 * 0.5) {
        // Way more than enough
        verdictBanner.className = 'verdict-banner success';
        verdictIcon.textContent = 'ğŸ¯';
        verdictTitle.textContent = "You're Set for Life!";
        verdictMessage.innerHTML = `
          With <strong>${formatCurrency(remainingAt90)}</strong> remaining at 90, you're over-saving in tax-advantaged accounts.
          Consider reducing 401k contributions beyond the employer match and investing in taxable accounts
          for more flexibility and lower RMDs.
        `;
      } else if (remainingAt90 > 0) {
        // On track
        verdictBanner.className = 'verdict-banner success';
        verdictIcon.textContent = 'âœ…';
        verdictTitle.textContent = "You're On Track!";
        verdictMessage.innerHTML = `
          You'll have <strong>${formatCurrency(remainingAt90)}</strong> remaining at 90.
          Your current savings plan will sustain $400K/year withdrawals for 30 years.
          Keep up the good work!
        `;
      } else {
        // Not enough
        verdictBanner.className = 'verdict-banner danger';
        verdictIcon.textContent = 'âš ï¸';
        verdictTitle.textContent = "You Need More Savings";
        verdictMessage.innerHTML = `
          At your current trajectory, you may run out of money before 90.
          Consider maximizing 401k contributions, delaying retirement, or adjusting
          your expected retirement income.
        `;
      }

      // Update Chart
      updateChart(yearlyData, RETIREMENT_AGE);

      // Show results
      document.getElementById('results').classList.add('visible');
      document.getElementById('results').scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    function updateChart(yearlyData, retirementAge) {
      const ctx = document.getElementById('wealthChart').getContext('2d');

      // Prepare data
      const labels = yearlyData.map(d => d.age);
      const balances = yearlyData.map(d => d.balance);

      // Find retirement index
      const retirementIndex = yearlyData.findIndex(d => d.age === retirementAge);

      // Create gradient colors
      const accumulationColor = '#3B82F6';
      const decumulationColor = '#00D632';

      if (wealthChart) {
        wealthChart.destroy();
      }

      wealthChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels,
          datasets: [{
            label: 'Portfolio Balance',
            data: balances,
            borderColor: function(context) {
              const index = context.dataIndex;
              return index <= retirementIndex ? accumulationColor : decumulationColor;
            },
            backgroundColor: function(context) {
              const chart = context.chart;
              const { ctx, chartArea } = chart;
              if (!chartArea) return null;

              const gradient = ctx.createLinearGradient(0, chartArea.bottom, 0, chartArea.top);
              gradient.addColorStop(0, 'rgba(0, 214, 50, 0.05)');
              gradient.addColorStop(1, 'rgba(59, 130, 246, 0.2)');
              return gradient;
            },
            borderWidth: 3,
            fill: true,
            tension: 0.3,
            pointRadius: 0,
            pointHoverRadius: 6,
            pointHoverBackgroundColor: '#FFFFFF',
            pointHoverBorderColor: '#00D632',
            pointHoverBorderWidth: 2
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          interaction: {
            mode: 'index',
            intersect: false
          },
          plugins: {
            legend: { display: false },
            tooltip: {
              backgroundColor: '#1A1A1A',
              titleColor: '#FFFFFF',
              bodyColor: '#A3A3A3',
              borderColor: 'rgba(255, 255, 255, 0.1)',
              borderWidth: 1,
              padding: 12,
              displayColors: false,
              callbacks: {
                title: function(context) {
                  const age = context[0].label;
                  if (age < retirementAge) {
                    return `Age ${age} (Accumulating)`;
                  } else if (age == retirementAge) {
                    return `Age ${age} (Retirement!)`;
                  } else {
                    return `Age ${age} (Withdrawing)`;
                  }
                },
                label: function(context) {
                  return 'Balance: ' + formatCurrency(context.parsed.y);
                }
              }
            },
            annotation: {
              annotations: {
                retirementLine: {
                  type: 'line',
                  xMin: retirementAge,
                  xMax: retirementAge,
                  borderColor: '#C9A227',
                  borderWidth: 2,
                  borderDash: [6, 6],
                  label: {
                    display: true,
                    content: 'Retirement',
                    position: 'start',
                    backgroundColor: '#C9A227',
                    color: '#000',
                    font: { size: 11, weight: 'bold' }
                  }
                }
              }
            }
          },
          scales: {
            x: {
              title: {
                display: true,
                text: 'Age',
                color: '#737373',
                font: { size: 12 }
              },
              grid: { color: 'rgba(255, 255, 255, 0.05)' },
              ticks: {
                color: '#737373',
                maxTicksLimit: 12,
                callback: function(value, index) {
                  const age = this.getLabelForValue(value);
                  if (age === retirementAge) return '60 â˜…';
                  return age;
                }
              }
            },
            y: {
              title: {
                display: true,
                text: 'Portfolio Balance',
                color: '#737373',
                font: { size: 12 }
              },
              grid: { color: 'rgba(255, 255, 255, 0.05)' },
              ticks: {
                color: '#737373',
                callback: function(value) {
                  return formatCurrency(value);
                }
              }
            }
          }
        }
      });
    }

    // Calculate on page load
    document.addEventListener('DOMContentLoaded', calculate);
  </script>
</body>
</html>
